import React from "react";

export const ResultsList = ({ cveList, isSearching, totalResults }) => {
  return (
    <div>
      <h2>Matching CVEs ({totalResults} total):</h2>
      {isSearching ? (
        <div>Searching...</div>
      ) : (
        <ul>
          {cveList.map((cve) => (
            <CveItem cve={cve} />
          ))}
        </ul>
      )}
    </div>
  );
};

function CveItem({ cve }) {
  return (
    <li>
      <strong>CVE-ID:</strong> {cve.cve.CVE_data_meta.ID}
      <br />
      <strong>Summary:</strong> {cve.cve.description.description_data[0].value}
      <br />
      <strong>CVSSv2.0 Base Score:</strong> {cve.impact.baseMetricV2?.cvssV2?.baseScore || "N/A"}
      <br />
      <strong>CVSSv3.1 Base Score:</strong> {cve.impact.baseMetricV3?.cvssV3?.baseScore || "N/A"}
      <br />
      <strong>Published Date:</strong> {cve.publishedDate}
    </li>
  );
}
