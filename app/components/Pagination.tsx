import React from "react";
import { PageButton } from "./PageButton";

type Props = {
  currentPage: number;
  totalPages: number;
  onClick: (page) => void;
};

// 現在のページ、トータルページ数、ページ変更時のイベントハンドラを受け取る
export const Pagination: React.FC<Props> = (props) => {
  const renderButtons = () => {
    let pages = [];
    let buttons = [];
    if (props.totalPages <= 7) {
      pages = [1, 2, 3, 4, 5, 6, 7];
    } else {
      if (props.currentPage <= 4) {
        pages = [1, 2, 3, 4, 5, "...", props.totalPages];
      } else if (props.currentPage >= props.totalPages - 4) {
        pages = [1, "...", props.totalPages - 4, props.totalPages - 3, props.totalPages - 2, props.totalPages - 1, props.totalPages];
      } else {
        pages = [1, "...", props.currentPage - 1, props.currentPage, props.currentPage + 1, "...", props.totalPages];
      }
    }
    pages.map((page) => {
      buttons.push(
        page === "..." ? (
          <span className="flex items-center justify-center px-3 py-2 mx-1">...</span>
        ) : (
          <PageButton page={page} onClick={props.onClick} currentPage={props.currentPage}>
            {page}
          </PageButton>
        )
      );
    });
    return buttons;
  };

  return <div className="flex mt-2">{renderButtons()}</div>;
};
