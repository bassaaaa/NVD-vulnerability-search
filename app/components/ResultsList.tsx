import React from "react";

export const ResultsList = ({ cveList, isSearching, totalResults }) => (
  <div>
    <h2>Matching CVEs ({totalResults} total):</h2>
    {/* 検索中の場合はローディング表示、そうでなければ結果をリスト表示 */}
    {isSearching ? (
      <div>Searching...</div>
    ) : (
      <ul>
        {cveList.map((cve) => (
          <CveItem key={cve.cve.CVE_data_meta.ID} cve={cve} />
        ))}
      </ul>
    )}
  </div>
);

const CveItem = ({ cve }) => (
  <li className="mt-2 px-8 py-4 bg-white rounded-lg shadow-md">
    <h2 className="text-xl font-bold text-gray-700">{cve.cve.CVE_data_meta.ID}</h2>
    <p className="mt-2 text-gray-600">{cve.cve.description.description_data[0].value}</p>
    <strong>CVSSv2.0 Base Score:</strong> {cve.impact.baseMetricV2?.cvssV2?.baseScore || "N/A"}
    <br />
    <strong>CVSSv3.1 Base Score:</strong> {cve.impact.baseMetricV3?.cvssV3?.baseScore || "N/A"}
    <br />
    <strong>Published Date:</strong> {cve.publishedDate}
  </li>
);
